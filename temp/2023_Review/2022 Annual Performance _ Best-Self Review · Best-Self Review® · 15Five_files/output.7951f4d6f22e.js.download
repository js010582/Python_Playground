$(function(){'use strict';var $container=$('.js-review-template-sections-container');var $loadingIndicator=$('.js-template-sections-loading');function sortSections(){$container.children().toArray().sort(function(x,y){return $(x).data().displayOrder-$(y).data().displayOrder;}).forEach(function(node){return $container.append(node);});}
if($container.children('.sortable-section').length>1){var $childrenWithoutDisplayOrder=$container.children(':not([data-display-order])').detach();sortSections();$childrenWithoutDisplayOrder.each(function(_index,element){var $element=$(element);var displayOrder=$element.data('showBefore');if(displayOrder){$container.find(".sortable-section[data-display-order=\"".concat(displayOrder,"\"]")).before($element);}});}
$loadingIndicator.prop('hidden',true);$container.prop('hidden',false);autosize.update($container.find('.js-autosize'));});;!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).dragula=e()}(function(){return function o(r,i,u){function c(t,e){if(!i[t]){if(!r[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(a)return a(t,!0);throw(n=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=i[t]={exports:{}},r[t][0].call(n.exports,function(e){return c(r[t][1][e]||e)},n,n.exports,o,r,i,u)}return i[t].exports}for(var a="function"==typeof require&&require,e=0;e<u.length;e++)c(u[e]);return c}({1:[function(e,t,n){"use strict";var o={},r="(?:^|\\s)",i="(?:\\s|$)";function u(e){var t=o[e];return t?t.lastIndex=0:o[e]=t=new RegExp(r+e+i,"g"),t}t.exports={add:function(e,t){var n=e.className;n.length?u(t).test(n)||(e.className+=" "+t):e.className=t},rm:function(e,t){e.className=e.className.replace(u(t)," ").trim()}}},{}],2:[function(e,t,n){(function(r){"use strict";var M=e("contra/emitter"),k=e("crossvent"),j=e("./classes"),R=document,q=R.documentElement;function U(e,t,n,o){r.navigator.pointerEnabled?k[t](e,{mouseup:"pointerup",mousedown:"pointerdown",mousemove:"pointermove"}[n],o):r.navigator.msPointerEnabled?k[t](e,{mouseup:"MSPointerUp",mousedown:"MSPointerDown",mousemove:"MSPointerMove"}[n],o):(k[t](e,{mouseup:"touchend",mousedown:"touchstart",mousemove:"touchmove"}[n],o),k[t](e,n,o))}function K(e){if(void 0!==e.touches)return e.touches.length;if(void 0!==e.which&&0!==e.which)return e.which;if(void 0!==e.buttons)return e.buttons;e=e.button;return void 0!==e?1&e?1:2&e?3:4&e?2:0:void 0}function z(e,t){return void 0!==r[t]?r[t]:(q.clientHeight?q:R.body)[e]}function H(e,t,n){var o=(e=e||{}).className||"";return e.className+=" gu-hide",n=R.elementFromPoint(t,n),e.className=o,n}function V(){return!1}function $(){return!0}function G(e){return e.width||e.right-e.left}function J(e){return e.height||e.bottom-e.top}function Q(e){return e.parentNode===R?null:e.parentNode}function W(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"SELECT"===e.tagName||function e(t){if(!t)return!1;if("false"===t.contentEditable)return!1;if("true"===t.contentEditable)return!0;return e(Q(t))}(e)}function Z(t){return t.nextElementSibling||function(){var e=t;for(;e=e.nextSibling,e&&1!==e.nodeType;);return e}()}function ee(e,t){var t=(n=t).targetTouches&&n.targetTouches.length?n.targetTouches[0]:n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,n={pageX:"clientX",pageY:"clientY"};return e in n&&!(e in t)&&n[e]in t&&(e=n[e]),t[e]}t.exports=function(e,t){var l,f,s,d,m,o,r,v,p,h,n;1===arguments.length&&!1===Array.isArray(e)&&(t=e,e=[]);var i,g=null,y=t||{};void 0===y.moves&&(y.moves=$),void 0===y.accepts&&(y.accepts=$),void 0===y.invalid&&(y.invalid=function(){return!1}),void 0===y.containers&&(y.containers=e||[]),void 0===y.isContainer&&(y.isContainer=V),void 0===y.copy&&(y.copy=!1),void 0===y.copySortSource&&(y.copySortSource=!1),void 0===y.revertOnSpill&&(y.revertOnSpill=!1),void 0===y.removeOnSpill&&(y.removeOnSpill=!1),void 0===y.direction&&(y.direction="vertical"),void 0===y.ignoreInputTextSelection&&(y.ignoreInputTextSelection=!0),void 0===y.mirrorContainer&&(y.mirrorContainer=R.body);var w=M({containers:y.containers,start:function(e){e=S(e);e&&C(e)},end:O,cancel:L,remove:X,destroy:function(){c(!0),N({})},canMove:function(e){return!!S(e)},dragging:!1});return!0===y.removeOnSpill&&w.on("over",function(e){j.rm(e,"gu-hide")}).on("out",function(e){w.dragging&&j.add(e,"gu-hide")}),c(),w;function u(e){return-1!==w.containers.indexOf(e)||y.isContainer(e)}function c(e){e=e?"remove":"add";U(q,e,"mousedown",E),U(q,e,"mouseup",N)}function a(e){U(q,e?"remove":"add","mousemove",x)}function b(e){e=e?"remove":"add";k[e](q,"selectstart",T),k[e](q,"click",T)}function T(e){i&&e.preventDefault()}function E(e){var t,n;o=e.clientX,r=e.clientY,1!==K(e)||e.metaKey||e.ctrlKey||(n=S(t=e.target))&&(i=n,a(),"mousedown"===e.type&&(W(t)?t.focus():e.preventDefault()))}function x(e){if(i)if(0!==K(e)){if(!(void 0!==e.clientX&&Math.abs(e.clientX-o)<=(y.slideFactorX||0)&&void 0!==e.clientY&&Math.abs(e.clientY-r)<=(y.slideFactorY||0))){if(y.ignoreInputTextSelection){var t=ee("clientX",e)||0,n=ee("clientY",e)||0;if(W(R.elementFromPoint(t,n)))return}n=i;a(!0),b(),O(),C(n);n=function(e){e=e.getBoundingClientRect();return{left:e.left+z("scrollLeft","pageXOffset"),top:e.top+z("scrollTop","pageYOffset")}}(s);d=ee("pageX",e)-n.left,m=ee("pageY",e)-n.top,j.add(h||s,"gu-transit"),function(){if(l)return;var e=s.getBoundingClientRect();(l=s.cloneNode(!0)).style.width=G(e)+"px",l.style.height=J(e)+"px",j.rm(l,"gu-transit"),j.add(l,"gu-mirror"),y.mirrorContainer.appendChild(l),U(q,"add","mousemove",P),j.add(y.mirrorContainer,"gu-unselectable"),w.emit("cloned",l,s,"mirror")}(),P(e)}}else N({})}function S(e){if(!(w.dragging&&l||u(e))){for(var t=e;Q(e)&&!1===u(Q(e));){if(y.invalid(e,t))return;if(!(e=Q(e)))return}var n=Q(e);if(n)if(!y.invalid(e,t))if(y.moves(e,n,t,Z(e)))return{item:e,source:n}}}function C(e){var t,n;t=e.item,n=e.source,("boolean"==typeof y.copy?y.copy:y.copy(t,n))&&(h=e.item.cloneNode(!0),w.emit("cloned",h,e.item,"copy")),f=e.source,s=e.item,v=p=Z(e.item),w.dragging=!0,w.emit("drag",s,f)}function O(){var e;w.dragging&&_(e=h||s,Q(e))}function I(){a(!(i=!1)),b(!0)}function N(e){var t,n;I(),w.dragging&&(t=h||s,n=ee("clientX",e)||0,e=ee("clientY",e)||0,(e=B(H(l,n,e),n,e))&&(h&&y.copySortSource||!h||e!==f)?_(t,e):(y.removeOnSpill?X:L)())}function _(e,t){var n=Q(e);h&&y.copySortSource&&t===f&&n.removeChild(s),A(t)?w.emit("cancel",e,f,f):w.emit("drop",e,t,f,p),Y()}function X(){var e,t;w.dragging&&((t=Q(e=h||s))&&t.removeChild(e),w.emit(h?"cancel":"remove",e,t,f),Y())}function L(e){var t,n,o;w.dragging&&(t=0<arguments.length?e:y.revertOnSpill,!1===(e=A(o=Q(n=h||s)))&&t&&(h?o&&o.removeChild(h):f.insertBefore(n,v)),e||t?w.emit("cancel",n,f,f):w.emit("drop",n,o,f,p),Y())}function Y(){var e=h||s;I(),l&&(j.rm(y.mirrorContainer,"gu-unselectable"),U(q,"remove","mousemove",P),Q(l).removeChild(l),l=null),e&&j.rm(e,"gu-transit"),n&&clearTimeout(n),w.dragging=!1,g&&w.emit("out",e,g,f),w.emit("dragend",e),f=s=h=v=p=n=g=null}function A(e,t){t=void 0!==t?t:l?p:Z(h||s);return e===f&&t===v}function B(t,n,o){for(var r=t;r&&!function(){if(!1===u(r))return!1;var e=D(r,t),e=F(r,e,n,o);if(A(r,e))return!0;return y.accepts(s,r,f,e)}();)r=Q(r);return r}function P(e){if(l){e.preventDefault();var t=ee("clientX",e)||0,n=ee("clientY",e)||0,o=t-d,r=n-m;l.style.left=o+"px",l.style.top=r+"px";var i=h||s,e=H(l,t,n),o=B(e,t,n),u=null!==o&&o!==g;!u&&null!==o||(g&&a("out"),g=o,u&&a("over"));r=Q(i);if(o!==f||!h||y.copySortSource){var c,e=D(o,e);if(null!==e)c=F(o,e,t,n);else{if(!0!==y.revertOnSpill||h)return void(h&&r&&r.removeChild(i));c=v,o=f}(null===c&&u||c!==i&&c!==Z(i))&&(p=c,o.insertBefore(i,c),w.emit("shadow",i,o,f))}else r&&r.removeChild(i)}function a(e){w.emit(e,i,g,f)}}function D(e,t){for(var n=t;n!==e&&Q(n)!==e;)n=Q(n);return n===q?null:n}function F(r,t,i,u){var c="horizontal"===y.direction;return(t!==r?function(){var e=t.getBoundingClientRect();if(c)return n(i>e.left+G(e)/2);return n(u>e.top+J(e)/2)}:function(){var e,t,n,o=r.children.length;for(e=0;e<o;e++){if(t=r.children[e],n=t.getBoundingClientRect(),c&&n.left+n.width/2>i)return t;if(!c&&n.top+n.height/2>u)return t}return null})();function n(e){return e?Z(t):t}}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./classes":1,"contra/emitter":5,crossvent:6}],3:[function(e,t,n){t.exports=function(e,t){return Array.prototype.slice.call(e,t)}},{}],4:[function(e,t,n){"use strict";var o=e("ticky");t.exports=function(e,t,n){e&&o(function(){e.apply(n||null,t||[])})}},{ticky:10}],5:[function(e,t,n){"use strict";var c=e("atoa"),a=e("./debounce");t.exports=function(r,e){var i=e||{},u={};return void 0===r&&(r={}),r.on=function(e,t){return u[e]?u[e].push(t):u[e]=[t],r},r.once=function(e,t){return t._once=!0,r.on(e,t),r},r.off=function(e,t){var n=arguments.length;if(1===n)delete u[e];else if(0===n)u={};else{e=u[e];if(!e)return r;e.splice(e.indexOf(t),1)}return r},r.emit=function(){var e=c(arguments);return r.emitterSnapshot(e.shift()).apply(this,e)},r.emitterSnapshot=function(o){var e=(u[o]||[]).slice(0);return function(){var t=c(arguments),n=this||r;if("error"===o&&!1!==i.throws&&!e.length)throw 1===t.length?t[0]:t;return e.forEach(function(e){i.async?a(e,t,n):e.apply(n,t),e._once&&r.off(o,e)}),r}},r}},{"./debounce":4,atoa:3}],6:[function(n,o,e){(function(r){"use strict";var i=n("custom-event"),u=n("./eventmap"),c=r.document,e=function(e,t,n,o){return e.addEventListener(t,n,o)},t=function(e,t,n,o){return e.removeEventListener(t,n,o)},a=[];function l(e,t,n){t=function(e,t,n){var o,r;for(o=0;o<a.length;o++)if((r=a[o]).element===e&&r.type===t&&r.fn===n)return o}(e,t,n);if(t){n=a[t].wrapper;return a.splice(t,1),n}}r.addEventListener||(e=function(e,t,n){return e.attachEvent("on"+t,function(e,t,n){var o=l(e,t,n)||function(n,o){return function(e){var t=e||r.event;t.target=t.target||t.srcElement,t.preventDefault=t.preventDefault||function(){t.returnValue=!1},t.stopPropagation=t.stopPropagation||function(){t.cancelBubble=!0},t.which=t.which||t.keyCode,o.call(n,t)}}(e,n);return a.push({wrapper:o,element:e,type:t,fn:n}),o}(e,t,n))},t=function(e,t,n){n=l(e,t,n);if(n)return e.detachEvent("on"+t,n)}),o.exports={add:e,remove:t,fabricate:function(e,t,n){var o=-1===u.indexOf(t)?new i(t,{detail:n}):function(){var e;c.createEvent?(e=c.createEvent("Event")).initEvent(t,!0,!0):c.createEventObject&&(e=c.createEventObject());return e}();e.dispatchEvent?e.dispatchEvent(o):e.fireEvent("on"+t,o)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./eventmap":7,"custom-event":8}],7:[function(e,r,t){(function(e){"use strict";var t=[],n="",o=/^on/;for(n in e)o.test(n)&&t.push(n.slice(2));r.exports=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(e,n,t){(function(e){var t=e.CustomEvent;n.exports=function(){try{var e=new t("cat",{detail:{foo:"bar"}});return"cat"===e.type&&"bar"===e.detail.foo}catch(e){}}()?t:"undefined"!=typeof document&&"function"==typeof document.createEvent?function(e,t){var n=document.createEvent("CustomEvent");return t?n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail):n.initCustomEvent(e,!1,!1,void 0),n}:function(e,t){var n=document.createEventObject();return n.type=e,t?(n.bubbles=Boolean(t.bubbles),n.cancelable=Boolean(t.cancelable),n.detail=t.detail):(n.bubbles=!1,n.cancelable=!1,n.detail=void 0),n}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],9:[function(e,t,n){var o,r,t=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function c(t){if(o===setTimeout)return setTimeout(t,0);if((o===i||!o)&&setTimeout)return o=setTimeout,setTimeout(t,0);try{return o(t,0)}catch(e){try{return o.call(null,t,0)}catch(e){return o.call(this,t,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:i}catch(e){o=i}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(e){r=u}}();var a,l=[],f=!1,s=-1;function d(){f&&a&&(f=!1,a.length?l=a.concat(l):s=-1,l.length&&m())}function m(){if(!f){var e=c(d);f=!0;for(var t=l.length;t;){for(a=l,l=[];++s<t;)a&&a[s].run();s=-1,t=l.length}a=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(e)}}function v(e,t){this.fun=e,this.array=t}function p(){}t.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new v(e,t)),1!==l.length||f||c(m)},v.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=p,t.addListener=p,t.once=p,t.off=p,t.removeListener=p,t.removeAllListeners=p,t.emit=p,t.prependListener=p,t.prependOnceListener=p,t.listeners=function(e){return[]},t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(e){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],10:[function(e,n,t){(function(t){var e="function"==typeof t?function(e){t(e)}:function(e){setTimeout(e,0)};n.exports=e}).call(this,e("timers").setImmediate)},{timers:11}],11:[function(a,e,l){(function(e,t){var o=a("process/browser.js").nextTick,n=Function.prototype.apply,r=Array.prototype.slice,i={},u=0;function c(e,t){this._id=e,this._clearFn=t}l.setTimeout=function(){return new c(n.call(setTimeout,window,arguments),clearTimeout)},l.setInterval=function(){return new c(n.call(setInterval,window,arguments),clearInterval)},l.clearTimeout=l.clearInterval=function(e){e.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},l.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},l.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},l._unrefActive=l.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},l.setImmediate="function"==typeof e?e:function(e){var t=u++,n=!(arguments.length<2)&&r.call(arguments,1);return i[t]=!0,o(function(){i[t]&&(n?e.apply(null,n):e.call(null),l.clearImmediate(t))}),t},l.clearImmediate="function"==typeof t?t:function(e){delete i[e]}}).call(this,a("timers").setImmediate,a("timers").clearImmediate)},{"process/browser.js":9,timers:11}]},{},[2])(2)});;$(function onReadyReportDetail(){'use strict';var isUnloading=false;function setDraftSavedTime(time){$('.js-draft-saved-time').text(time);$('.js-draft-saved-text').prop('hidden',false);}
function removeEmptyErrorPopover(){var $this=$(this);if($this.data('hasEmptyAnswerErrorPopover')){$this.popover('dispose');$this.removeData('hasEmptyAnswerErrorPopover');}}
function removeAnswer($answer){if($answer.is(':disabled')){return;}
$answer.closest('.js-answer-base').prevUntil('.js-answer-base','.js-answer-error-note').fadeOut(removeElement);$answer.prop('disabled',true).closest('.answer-base').fadeOut(removeElement);$answer.popover('dispose');}
function getEmptyNewAnswers($answer){return $answer.closest('.question-answers').find('.is-new-answer:not(:disabled)');}
function hasAttachment(answer){return!!$(answer).siblings('.js-attachments-container').children('.js-attachment').length;}
var addNewMultiAnswerField=throttle(function addNewMultiAnswerField(questionId,target){var $questionBase=$(target).closest('.question-answers');var $lastAnswer=$questionBase.find('.answer-base').last().find('textarea.js-review-answer');if(!$.trim($lastAnswer.val())&&!hasAttachment($lastAnswer)){return null;}
$questionBase.parent().removeClass('answer-error');var $answerTemplate=$questionBase.find('.js-review-answer-template');var $newAnswerBase=$($answerTemplate.html()).hide().insertBefore($answerTemplate).slideDown('fast');var clientId=generateRandomSubmissionClientId();var name='q_'+questionId+'_a_new_'+clientId;var $newAnswer=$newAnswerBase.find('textarea.js-review-answer').attr('id',name).attr('name',name).data('clientId',clientId).autosize();$newAnswerBase.find('label').attr('for',name);return $newAnswer;},1000);function onMultiAnswerInput(){var $questionAnswersBase=$(this).closest('.question-answers');addNewMultiAnswerField($questionAnswersBase.data('questionId'),$questionAnswersBase);}
function deleteAnswer(answer){var $answer=$(answer);var $data=$answer.data();var id=$data.id;var questionId=$data.questionId;var questionType=$data.questionType;if(!id){return $.when();}
return $.post(Urls['reviews:fillout:answer_delete'](),{id:id}).then(throwErrorResponse).catch(showErrorPopoverAsync($answer,'An error occurred while removing your answer.',deleteAnswer.bind(null,$answer))).then(destroyErrorPopoverAsync($answer)).then(function onSuccess(){if(questionType==='multi'){removeAnswer($answer);return;}
var clientId=generateRandomSubmissionClientId();var name='q_'+questionId+'_a_new_'+clientId;$answer.val('').attr('id',name).attr('name',name).data('id','').data('clientId',clientId).addClass('is-new-answer').removeClass('is-saved-answer');$answer.parent().removeClass('sortable-answer');});}
function saveAnswer(answer,options){var $answer=$(answer);var $attachmentAdd=$answer.parent().find('.js-attachment-add');var $answerLabel=$answer.parent().find('.js-answer-label');var text=$answer.val().trim();var $data=$answer.data();var id=$data.id;var reviewId=$data.reviewId;var reviewType=$data.reviewType;var questionId=$data.questionId;var clientId=$data.clientId;var isQuestionPerObjective=$data.isQuestionPerObjective;var objectiveId=$data.objectiveId;var keyResultId=$data.keyResultId;var lastSavedText=$data.lastSavedText;var isNewAnswer=$answer.hasClass('is-new-answer');var hasAttachments=hasAttachment($answer);if(isUnloading){return $.when();}
if(isNewAnswer&&!text&&!hasAttachments){if(getEmptyNewAnswers($answer).length>1){$attachmentAdd.data('isTargetDeleted',true).removeData('targetId');removeAnswer($answer);}
return $.when();}
if(id&&!text&&!hasAttachments){var deleteAnswerResult=deleteAnswer($answer);$attachmentAdd.data('isTargetDeleted',true);deleteAnswerResult.done(function deletaAnswerDone(){$attachmentAdd.removeData('targetId');}).always(function deleteAnswerAlways(){$attachmentAdd.data('isTargetDeleted',false);});return deleteAnswerResult;}
if(!text&&!(options&&options.suppressValidationMessage)){showErrorPopover($answer,renameFeatures(gettext('A written answer is also needed before submitting your review')));$answer.data('hasEmptyAnswerErrorPopover',true);}
if(!text&&options&&options.autoFocusEmptyAnswer){$answer.focus();}
if(!isNewAnswer&&text===lastSavedText){return $.when();}
var data={id:id,review_id:reviewId,review_type:reviewType,question_id:questionId,client_id:clientId,answer_text:text,};if(isQuestionPerObjective){data.objective_id=objectiveId;data.key_result_id=keyResultId;}
toggleSpinnerIcon($answer,true);var request=$.post(Urls['reviews:fillout:answer_save'](),data).then(throwErrorResponse).catch(function onError(err){toggleSpinnerIcon($answer,false);throw err;}).catch(showErrorPopoverAsync($answer,'An error occurred while saving your answer.',saveAnswer.bind(null,answer,options))).then(destroyErrorPopoverAsync($answer)).then(function onSuccess(res){var name='q_'+questionId+'_a_'+res.id;$answer.addClass('is-saved-answer').removeClass('is-new-answer').attr('id',name).attr('name',name).data('id',res.id).data('lastSavedText',text);$answerLabel.attr('for',name);$answer.parent().addClass('sortable-answer');if(res.new_answer&&res.question_type==='multi'){addNewMultiAnswerField(questionId,$answer.closest('.question-answers'));}
showSavedIcon($answer);setDraftSavedTime(res.save_ts_display);return res;});var reportItemId=request.then(function onReportItemSaved(res){return res.id;});$attachmentAdd.data('targetId',reportItemId);return request;}
function saveAnswersOrder(el,target){var $target=$(target);var questionId=$target.data('questionId');var answerIds=$target.find('.sortable-answer .is-saved-answer').get().map(function map(answer){return $(answer).data('id');}).filter(Boolean);if(answerIds.length<=1){return;}
$.post(Urls['reviews:fillout:reorder_answers'](),{q_id:questionId,ordered_a_id_str:answerIds.join(),}).then(throwErrorResponse).catch(showAjaxError('An error occurred while reordering your answers.'));}
function showMetricDetails($el){var $container=$el.closest('.js-metric__content');var selectedClass='selected';$container.addClass(selectedClass);}
function saveMetricAnswer(answer){var $answer=$(answer);var $data=$answer.data();var reviewId=$data.reviewId;var reviewType=$data.reviewType;var questionId=$data.questionId;var isQuestionPerObjective=$data.isQuestionPerObjective;var objectiveId=$data.objectiveId;var keyResultId=$data.keyResultId;var isMultipleChoice=$data.isMultipleChoice||null;var clientId=$answer.hasClass('js-metric-answer-details')?$data.clientId:$answer.closest('.js-metric__content').data('clientId');var data={review_id:reviewId,review_type:reviewType,question_id:questionId,client_id:clientId,is_multiple_choice:isMultipleChoice,};if(isQuestionPerObjective){data.objective_id=objectiveId;data.key_result_id=keyResultId;}
if(isMultipleChoice){data.checked=$answer.prop('checked');data.client_id=generateRandomSubmissionClientId();}
if($answer.hasClass('js-metric-answer-details')){data.answer_text=$answer.val();}else{data.answer_value=$answer.val();}
$.post(Urls['reviews:fillout:metric_answer_save'](),data).then(throwErrorResponse).catch(showAjaxError('An error occurred while saving your answer.')).then(function onSuccess(res){showMetricDetails($answer);setDraftSavedTime(res.save_ts_display);});}
function deleteReviewNote(reviewNote){var $reviewNote=$(reviewNote);var $data=$reviewNote.data();var participantId=$data.participantId;var data={participant_id:participantId,};return $.post(Urls['reviews:fillout:review_note_delete'](),data).then(throwErrorResponse).catch(showErrorPopoverAsync($reviewNote,'An error occurred while removing your note.',deleteReviewNote.bind(null,reviewNote))).then(destroyErrorPopoverAsync($reviewNote));}
function saveReviewNote(reviewNote){var $reviewNote=$(reviewNote);var $data=$reviewNote.data();var text=$reviewNote.val().trim();var participantId=$data.participantId;if(!text){return deleteReviewNote($reviewNote);}
var data={participant_id:participantId,note_text:text,};return $.post(Urls['reviews:fillout:review_note_save'](),data).then(throwErrorResponse).catch(showErrorPopoverAsync($reviewNote,'An error occurred while saving your note.',saveReviewNote.bind(null,reviewNote))).then(destroyErrorPopoverAsync($reviewNote));}
var emptyAnswerMessageDragFix={onDrag:function onDrag(el,container){$(container).children('.js-answer-error-note').each(function each(){var $this=$(this);$this.nextAll('.js-answer-base').first().prepend($this);});},onRelease:function onRelease(el,container){$(container).find('.js-answer-base').children('.js-answer-error-note').each(function each(){var $this=$(this);$this.closest('.js-answer-base').before($this);});},};function initSortableAnswers(){$('.js-sortable-review-answers').each(function each(){dragula([this],{moves:function moves(el,source,handle){return $(handle).closest('.js-sortable-icon').length>0;},accepts:function accepts(el,target,source,sibling){return sibling&&$(sibling).children('.js-review-answer').length;},}).on('drop',saveAnswersOrder).on('drag',emptyAnswerMessageDragFix.onDrag).on('drop',emptyAnswerMessageDragFix.onRelease).on('cancel',emptyAnswerMessageDragFix.onRelease);});}
function setLastSavedText(index,el){var $el=$(el);$el.data('lastSavedText',$.trim($el.val()));}
function removeValidationError(){var $this=$(this);var $answerBase=$this.parent();removeEmptyErrorPopover.call(this);if($this.val().trim()&&$answerBase.hasClass('answer-base--empty-answer')&&$answerBase.closest('.js-fillout-report-empty-answers-error').length){$answerBase.removeClass('answer-base--empty-answer').prev().removeClass('answer-error-note--empty-answer');}}
function saveSummaryNote(el){var $this=$(el);var $field=$this.find('.js-summary-note-field');var $data=$field.data();var noteText=$field.val().trim();if(!noteText)return;var summaryData={participant_id:$data.participantId,question_id:$data.questionId,note_text:noteText,note_is_private:$data.isPrivate||false,};$.post(Urls['reviews:fillout:question_note_save'](),summaryData).then(throwErrorResponse).catch(showAjaxError('An error occurred while saving your summary note.')).then(function onSuccess(res){destroyErrorPopover($field);$field.data('summaryNoteId',res.note_id);});}
function toggleLock(){var $toggleLockButton=$(this);var $icon=$toggleLockButton.find('i');var $summary=$toggleLockButton.closest('.js-summary-note');var $field=$summary.find('.js-summary-note-field');var $privateLabel=$summary.next('.js-summary-note-private-label');var isPrivate=!$field.data('isPrivate');var makeVisibleLabel=$toggleLockButton.data('makeVisibleLabel');var makePrivateLabel=$toggleLockButton.data('makePrivateLabel');var summaryNoteId=$field.data('summaryNoteId');if(!summaryNoteId){$field.focus();return showErrorPopover($field,'A summary is needed before toggling privacy');}
$summary.toggleClass('is-private',isPrivate);$field.data('isPrivate',isPrivate);$icon.toggleClass('fa-lock',isPrivate).toggleClass('fa-unlock',!isPrivate);$privateLabel.prop('hidden',!isPrivate);$toggleLockButton.tooltip('hide').attr('data-original-title',isPrivate?makeVisibleLabel:makePrivateLabel);return $.post(Urls['reviews:fillout:question_note_toggle_privacy'](),{note_id:summaryNoteId,}).then(throwErrorResponse).catch(showAjaxError('An error occurred while saving your privacy.')).then(function onSuccess(){destroyErrorPopover($field);});}
initSortableAnswers();var $body=$('body');$('.js-review-answer.is-new-answer, .js-metric__content.is-new-answer').each(function each(){var $this=$(this);var $answerLabel=$this.parent().find('.js-answer-label');var name=$this.attr('name');var clientId=generateRandomSubmissionClientId();$this.data('clientId',clientId);if(name.match(/_new$/)){name=name+'_'+clientId;$this.attr('name',name).attr('id',name);$answerLabel.attr('for',name);}});$body.on('input','.multi-question-answers .js-review-answer',onMultiAnswerInput);$('.multi-question-answers .js-review-answer').each(setLastSavedText);$('.single-question-answers .js-review-answer').each(setLastSavedText);$('.question-answers').on('blur','textarea.js-review-answer',function onBlur(){saveAnswer(this);}).on('keydown','textarea.js-review-answer',function onKeyDown(event){if(/(Control|Meta)\+Enter/.test(hotkey(event))){event.preventDefault();if($(this).val().trim()){saveAnswer(this);}}}).on('input','textarea.js-review-answer',removeValidationError);$body.on('change','.js-metric-option',function onChange(){saveMetricAnswer(this);});$body.on('blur','textarea.js-metric-answer-details',function onBlur(){saveMetricAnswer(this);}).on('keydown','textarea.js-metric-answer-details',function onKeyDown(event){if(/(Control|Meta)\+Enter/.test(hotkey(event))){event.preventDefault();if($(this).val().trim()){saveMetricAnswer(this);}}});$body.on('blur','textarea.js-review-note',function onBlur(){saveReviewNote(this);}).on('keydown','textarea.js-review-note',function onKeyDown(event){if(/(Control|Meta)\+Enter/.test(hotkey(event))){event.preventDefault();if($(this).val().trim()){saveReviewNote(this);}}});$body.on('click','.js-summary-lock',toggleLock).on('blur','.js-summary-note',function manageSummaryNote(){saveSummaryNote(this);});});;$(function(){'use strict';var $body=$('body');var $confirmCheckbox=$('.js-review-summary-confirm-checkbox');var $submitButton=$('.js-review-summary-submit');var $acknowledgeCheckbox=$('.js-review-acknowledgement-checkbox');var $acknowledgedBy=$('.js-acknowledged-by-full-name');var $saveAcknowledgementBtn=$('.js-save-acknowledgement');$confirmCheckbox.on('change',function(){$submitButton.prop('disabled',!$confirmCheckbox.is(':checked'));});function saveAcknowledgement(e){var _$$data=$(e.target).data(),cycleId=_$$data.cycleId,participantFullName=_$$data.participantFullName;var providedName=$acknowledgedBy.val().trim();var url=Urls['reviews:fillout:api:acknowledge_participant_review'](cycleId);if(providedName!==participantFullName){$('.js-acknowledgement-error').html("Name mismatch! Your name in 15Five is: ".concat(DOMPurify.sanitize(participantFullName)," <br>\n        Please ensure the name you provided matches your name in the system and try again."));return;}
var data={acknowledged_by_full_name:providedName,acknowledged:$acknowledgeCheckbox.prop('checked')};$.post({url:url,data:JSON.stringify(data),contentType:'application/json'}).then(throwErrorResponse)["catch"](showAjaxError('An error occurred while saving acknowledgment.')).then(function(){window.location.reload();});}
function handleAcknowledgementFields(){$saveAcknowledgementBtn.prop('disabled',!$acknowledgeCheckbox.prop('checked')||!$acknowledgedBy.val().trim());}
$body.on('click','.js-save-acknowledgement',saveAcknowledgement).on('keyup','.js-acknowledged-by-full-name',handleAcknowledgementFields).on('change','.js-review-acknowledgement-checkbox',handleAcknowledgementFields);});;function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o;}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o;},_typeof(o);}
function _regeneratorRuntime(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime=function _regeneratorRuntime(){return e;};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value;},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e];}try{define({},"");}catch(t){define=function define(t,e,r){return t[e]=r;};}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a;}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)};}catch(t){return{type:"throw",arg:t};}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,function(){return this;});var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach(function(e){define(t,e,function(t){return this._invoke(e,t);});});}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then(function(t){invoke("next",t,i,a);},function(t){invoke("throw",t,i,a);}):e.resolve(h).then(function(t){u.value=t,i(u);},function(t){return invoke("throw",t,i,a);});}a(c.arg);}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e(function(e,r){invoke(t,n,e,r);});}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg();}});}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw new Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0};}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done};}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg);}};}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator["return"]&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y);}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e);}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e;}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0);}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next;};return i.next=i;}}throw new TypeError(_typeof(e)+" is not iterable");}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name));},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t;},e.awrap=function(t){return{__await:t};},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,function(){return this;}),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next();});},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,function(){return this;}),define(g,"toString",function(){return"[object Generator]";}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next;}return next.done=!0,next;};},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t);},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval;},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o;}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc);}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc);}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break;}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a);},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y;},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y;}},"catch":function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r);}return o;}}throw new Error("illegal catch attempt");},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y;}},e;}
function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value;}catch(error){reject(error);return;}if(info.done){resolve(value);}else{Promise.resolve(value).then(_next,_throw);}}
function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value);}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err);}_next(undefined);});};}
$(function(){'use strict';function togglePropHidden(el){$(el).prop('hidden',function(i,value){return!value;});}
function toggleFlaggedState(classToToggle){var $this=$(this);var $answerActions=$this.find('.js-reviews-submitted-answer-actions');var $note=$this.find('.js-flagged-submitted-answer-note');togglePropHidden($answerActions);$note.each(function(i,el){return togglePropHidden(el);});if(classToToggle){$this.toggleClass(classToToggle);}}
function confirmAction(actionButton){var $actionButton=$(actionButton);var _$actionButton$data=$actionButton.data(),confirmTarget=_$actionButton$data.confirmTarget,userNamePossessive=_$actionButton$data.userNamePossessive;var $confirmTarget=$(confirmTarget);$confirmTarget.one('show.bs.modal',function(){$confirmTarget.find('.js-user-full-name-possessive').text(userNamePossessive);$confirmTarget.find('.js-reviews-answer-delete-modal-content').html($actionButton.closest('.js-reviews-submitted-answer').find('.js-reviews-submitted-answer-content').clone());});return $confirmTarget.confirm();}
function onFlagActionClick(){return _onFlagActionClick.apply(this,arguments);}
function _onFlagActionClick(){_onFlagActionClick=_asyncToGenerator(_regeneratorRuntime().mark(function _callee(){var $this,$answer,_$answer$data,flaggedClass,classToToggle,toggleAnswerFlaggedState,_$this$data,actionUrl,answerId,actionErrorMessage,actionSuccessMessage;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return confirmAction(this);case 2:if(_context.sent){_context.next=4;break;}
return _context.abrupt("return");case 4:$this=$(this);$answer=$this.closest('.js-reviews-submitted-answer');_$answer$data=$answer.data(),flaggedClass=_$answer$data.flaggedClass;classToToggle=!$answer.hasClass(flaggedClass)&&flaggedClass;toggleAnswerFlaggedState=toggleFlaggedState.bind($answer,classToToggle);_$this$data=$this.data(),actionUrl=_$this$data.actionUrl,answerId=_$this$data.answerId,actionErrorMessage=_$this$data.actionErrorMessage,actionSuccessMessage=_$this$data.actionSuccessMessage;toggleAnswerFlaggedState();$.post(actionUrl,{id:answerId}).then(throwErrorResponse)["catch"](showAjaxError(actionErrorMessage)).then(function(){return PNotify.success(actionSuccessMessage);})["catch"](toggleAnswerFlaggedState);case 12:case"end":return _context.stop();}},_callee,this);}));return _onFlagActionClick.apply(this,arguments);}
function toggleSection(){var $target=$($(this).data().target);var sectionName=$(this).data().sectionName;var isSectionHidden=$target.prop('hidden');if(isSectionHidden){$target.prop('hidden',false);$(this).text("Hide ".concat(sectionName.toLowerCase()));PNotify.success("".concat(sectionName," section is now visible."));}else{$target.prop('hidden',true);$(this).text("Show ".concat(sectionName.toLowerCase()));PNotify.success("".concat(sectionName," section is now hidden. This setting will reset upon next page reload."));}}
var $body=$('body');$('.js-reviews-flag-submitted-answer').on('click',onFlagActionClick);$body.on('click','.js-reviews-private-manager-assessment-toggle, .js-reviews-ratings-toggle',toggleSection);});;$(function(){'use strict';var DEFAULT_COUNT=10;var INCREMENT_BY=5;var Selector={USER_LIST:'.js-reviews-fillout-user-list',USER_LIST_ITEM:'.js-reviews-fillout-user-list-item',SHOW_MORE_BTN:'.js-reviews-fillout-show-more-btn',SHOW_LESS_BTN:'.js-reviews-fillout-show-less-btn',PARTICIPANT_SWITCHER:'.js-review-participant-switcher-select',PARTICIPANT_SWITCHER_BUTTON:'.js-review-participant-switcher-button',PARTICIPANT_SWITCHER_CONTAINER:'.js-review-participant-switcher-container',PARTICIPANT_OPTIONS_DIV:'.js-hidden-select-options'};var $participantSwitcheContainer=$(Selector.PARTICIPANT_SWITCHER_CONTAINER);var currentParticipantId=$participantSwitcheContainer.length?$participantSwitcheContainer.data().currentParticipantId:null;var items=$(Selector.PARTICIPANT_OPTIONS_DIV).children().toArray().map(function map(item){return{id:item.value,text:item.text,selected:item.selected};});if(items.length){var pageSize=100;$(Selector.PARTICIPANT_SWITCHER).select2({ajax:{transport:function transport(params,success){var _params$data,_params$data2;var page=((_params$data=params.data)===null||_params$data===void 0?void 0:_params$data.page)||1;var results=[];if((_params$data2=params.data)!==null&&_params$data2!==void 0&&_params$data2.term){results=items.filter(function filter(item){var _params$data3;return item.text.toUpperCase().indexOf((_params$data3=params.data)===null||_params$data3===void 0?void 0:_params$data3.term.toUpperCase())>=0;});}else{results=items;}
var data={results:results.slice((page-1)*pageSize,page*pageSize),pagination:{more:page*pageSize<results.length}};success(data);}}});}else{var $participantSwitcher=$(Selector.PARTICIPANT_SWITCHER);if($participantSwitcher.length){$participantSwitcher.select2().val(currentParticipantId).trigger('change');}}
function getShowMoreBtnText(count){return count?"View more (".concat(count,")"):'View more';}
$(Selector.USER_LIST).each(function each(){var $this=$(this);var $userListItems=$this.find(Selector.USER_LIST_ITEM);$userListItems.slice(0,DEFAULT_COUNT).prop('hidden',false);$userListItems.slice(DEFAULT_COUNT).prop('hidden',true);if($userListItems.length>DEFAULT_COUNT){$this.find('.js-reviews-fillout-show-more').prop('hidden',false);$this.find(Selector.SHOW_MORE_BTN).text(getShowMoreBtnText($userListItems.length-DEFAULT_COUNT));}});function showMoreUsers(){var $this=$(this);var $userListItems=$this.closest(Selector.USER_LIST).find(Selector.USER_LIST_ITEM);var visibleItemCount=$userListItems.not('[hidden]').length;$userListItems.slice(0,visibleItemCount+INCREMENT_BY).prop('hidden',false);var hiddenItemCount=$userListItems.filter('[hidden]').length;if(hiddenItemCount===0){$this.prop('hidden',true);$this.siblings(Selector.SHOW_LESS_BTN).prop('hidden',false);}else{$this.text(getShowMoreBtnText(hiddenItemCount));}}
function showLessUsers(){var $this=$(this);var $userListItems=$this.closest(Selector.USER_LIST).find(Selector.USER_LIST_ITEM);$userListItems.prop('hidden',function(index){return index+1>DEFAULT_COUNT;});$this.prop('hidden',true);$this.siblings(Selector.SHOW_MORE_BTN).text(getShowMoreBtnText($userListItems.length-DEFAULT_COUNT)).prop('hidden',false);}
function switchParticipant(){var $switcherButton=$(Selector.PARTICIPANT_SWITCHER_BUTTON);var newParticipantId=$(this).find('option:selected').val();$switcherButton.data('participantId',newParticipantId);$switcherButton.prop('disabled',Number(newParticipantId)===Number(currentParticipantId));}
function loadParticipant(){window.location.href=Urls['reviews:fillout:review']($(this).data().participantId);$(this).prop('disabled',true);}
$('body').on('click',Selector.SHOW_MORE_BTN,showMoreUsers).on('click',Selector.SHOW_LESS_BTN,showLessUsers).on('click',Selector.PARTICIPANT_SWITCHER_BUTTON,loadParticipant).on('change',Selector.PARTICIPANT_SWITCHER,switchParticipant);});;$(function(){'use strict';$('.js-objectives-answered-question').get().forEach(function(answer){var okrId=$(answer).data().objectivesQuestionOkrId;var $answerEl=$("[data-objective-in-reviews-okr-id=\"".concat(okrId,"\"]"));$answerEl.find('hr').before(answer);$answerEl.prop('hidden',false);$(answer).prop('hidden',false);});var $lastObjectiveAnswer=$('.js-objective-in-reviews-okr').last();var $lastObjectiveSummary=$('.js-objectives-question-summary').last();$lastObjectiveAnswer.find('hr').after($lastObjectiveSummary);$lastObjectiveSummary.prop('hidden',false);});;